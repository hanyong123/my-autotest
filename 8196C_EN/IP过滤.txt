*** Settings ***
Suite Setup       打开浏览器
Suite Teardown    关闭浏览器
Resource          keyword.txt

*** Test Cases ***
try
    转到IP过滤页面
    验证IP过滤规则名    aa'aa    sdsdsds

*** Keywords ***
验证IP过滤规则名
    [Arguments]    ${name}    ${message}
    设置IP过滤    des=${name}
    显示消息    ${message}

验证IP过滤规则名最大输入长度
    [Arguments]    ${name}    ${max_len}
    验证输入框最大输入长度    id=ip_describe    ${name}    ${max_len}

验证IP过滤源IP地址
    [Arguments]    ${ip}    ${message}
    设置IP过滤    shost=host    sip=${ip}
    显示消息    ${message}

验证IP过滤源子网地址
    [Arguments]    ${ip}    ${mask}    ${message}
    设置IP过滤    shost=sub_host    sip=${ip}    smask=${mask}
    显示消息    ${message}

验证IP过滤源网段地址
    [Arguments]    ${start_ip}    ${end_ip}    ${message}
    设置IP过滤    shost=ip_host    start_sip=${start_ip}    end_sip=${end_ip}
    显示消息    ${message}

验证IP过滤源IP地址最大输入长度
    [Arguments]    ${ip}    ${max_len}
    Select From List By Value    id=ip_src_sele    host
    验证输入框最大输入长度    id=ip_src_ip    ${ip}    ${max_len}

验证IP过滤源MASK地址最大输入长度
    [Arguments]    ${mask}    ${max_len}
    Select From List By Value    id=ip_src_sele    sub_host
    验证输入框最大输入长度    id=ip_src_mask    ${mask}    ${max_len}

验证IP过滤目的IP地址
    [Arguments]    ${ip}    ${message}
    设置IP过滤    dhost=host    dip=${ip}
    显示消息    ${message}

验证IP过滤目的子网地址
    [Arguments]    ${ip}    ${mask}    ${message}
    设置IP过滤    dhost=sub_host    dip=${ip}    dmask=${mask}
    显示消息    ${message}

验证IP过滤目的网段地址
    [Arguments]    ${start_ip}    ${end_ip}    ${message}
    设置IP过滤    dhost=ip_host    start_dip=${start_ip}    end_dip=${end_ip}
    显示消息    ${message}

验证IP过滤目的IP地址最大输入长度
    [Arguments]    ${ip}    ${max_len}
    Select From List By Value    id=ip_des_sele    host
    验证输入框最大输入长度    id=ip_des_ip    ${ip}    ${max_len}

验证IP过滤目的MASK地址最大输入长度
    [Arguments]    ${mask}    ${max_len}
    Select From List By Value    id=ip_des_sele    sub_host
    验证输入框最大输入长度    id=ip_des_mask    ${mask}    ${max_len}

验证IP过滤协议端口
    [Arguments]    ${start_port}    ${end_port}    ${message}
    设置IP过滤    protcol=TCP    start_port=${start_port}    end_port=${end_port}
    显示消息    ${message}

验证起始端口最大输入长度
    [Arguments]    ${port}    ${max_len}
    Select From List By Value    id=ip_proto    TCP
    验证输入框最大输入长度    id=ip_port_start    ${port}    ${max_len}

验证结束端口最大输入长度
    [Arguments]    ${port}    ${max_len}
    Select From List By Value    id=ip_proto    TCP
    验证输入框最大输入长度    id=ip_port_end    ${port}    ${max_len}

协议选择all,icmp时端口不能输入
    Select From List By Value    id=ip_proto    ALL
    Element Should Be Disabled    id=ip_port_start
    Element Should Be Disabled    id=ip_port_end
    Select From List By Value    id=ip_proto    ICMP
    Element Should Be Disabled    id=ip_port_start
    Element Should Be Disabled    id=ip_port_end

IP过滤列表里含有${string}
    Table Should Contain    xpath=//table[@class="df_tab"]    ${string}

IP过滤列表里没有${string}
    Run Keyword And Expect Error    *    Table Should Contain    xpath=//table[@class="df_tab"]    ${string}

IP过滤列表第${row}行第${col}列是${string}
    ${row}    Evaluate    int(${row})+1
    ${v}    Get Table Cell    xpath=//table[@class="df_tab"]    ${row}    ${col}
    Should Be Equal    ${v}    ${string}

点击IP过滤列表里第${row}行修改按钮
    Click Element    xpath=(//div[@class="tab_mod_btn"])[${row}]

删除IP过滤列表里所有条目显示成功消息${message}
    Click Element    id=del_ip_filter_all
    Choose Ok On Next Confirmation
    ${message}    Confirm Action
    显示消息    ${message}

删除IP过滤列表里第${row}行显示成功消息${message}
    Click Element    xpath=//div[@class="tab_del_btn"][${row}]
    显示消息    ${message}
